# Background
The sample code is part of a larger working web application for an e-commerce website that is built with Express framework (check out the <b>full backend code source</b> [here](https://github.com/krislee/ecommerce-backend)) and React framework (check out the <b>full client code source</b> [here](https://github.com/krislee/ecommerce-frontend)). The working <b>user interface website application</b> can be viewed [here](https://elecommerce.netlify.app/).

# Sample Code Explanation
The sample code is one of the bugs that I explained I solved in my Lyft's personal statement. For reference, my explanation is below:

One challenge I faced while building out a custom checkout was connecting the checkout shipping component with the checkout payment component on the client-side. When a customer clicks Next at the shipping component and arrives at the payment component, there needed to be a way to let the server know what the shipping address is to display on a receipt when an order is complete. At initial design, the server would create a new shipping address Mongo document when the customer clicks Next, and then use the Mongo document’s unique objectID identifier to look up the shipping address when it is time to display the receipt. 

However, I only wanted to create a new shipping address document for logged in customers who wanted to save a shipping address. Hence, the initial thought did not work for guest customers or logged in customers who did not want to save a shipping address. I had to come up with a solution that would work for both guests and logged in customers. The solution I derived to was storing the shipping address in the Stripe Payment Intent object when a guest or logged in customer clicks Next at the shipping component. This process involved making a call to the Stripe server and updating the Payment Intent object to store the shipping address information in its shipping and metadata property. After the customer completes the order, the Express server webhook will retrieve the shipping address from the Payment Intent’s shipping property to send back to the client to show in receipt. From the Payment Intent’s metadata property, the shipping address document’s objectID of an already saved shipping address for logged in customers would be retrieved to update that document’s lastUsed property to have a true value. Also from the Payment Intent’s metadata property, the Boolean value of saving an address or not for logged in customer who does not have any shipping addresses and saving his or her first shipping address is retrieved so that the server knows if it should make a new shipping address document. 
